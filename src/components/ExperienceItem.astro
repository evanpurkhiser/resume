---
import type {Experience} from '../types';
import {formatDateRange, formatDateRangeShort} from '../utils/dates';
import ItemCard from './ItemCard.astro';

interface Props {
  experience: Experience;
}

const {experience} = Astro.props;
const dateRange = formatDateRange(experience.dates.start, experience.dates.end);
const dateRangeShort = formatDateRangeShort(experience.dates.start, experience.dates.end);
---

<ItemCard title={experience.company} subtitle={experience.title}>
  <div slot="trailing" class="text-xs sm:text-sm text-slate-500">
    <span class="sm:hidden" aria-label={dateRange}>{dateRangeShort}</span>
    <span class="hidden sm:inline" aria-hidden="true">{dateRange}</span>
  </div>
  {experience.description && <p class="prose-text">{experience.description}</p>}

  {
    experience.sections.map(section => (
      <section class="flex flex-col gap-1">
        {section.heading && <h4 class="text-sm text-slate-500">{section.heading}</h4>}
        <ul class="flex flex-col gap-2">
          {section.bullets.map(bullet => (
            <li class="experience-bullet">{bullet}</li>
          ))}
        </ul>
      </section>
    ))
  }
</ItemCard>
